define(["jquery","jqueryui","core/config","core/ajax","core/notification","core/templates"],function(a,b,c,d,e,f){return{init:function(b,g){function h(b){if(a("#prospectivelist li").remove(),!b.length)return void a("#noprospective").show();a("#noprospective").hide();var d={courses:b,wwwroot:c.wwwroot,prospective:!0};f.render("local_iomad_learningpath/prospectivelist",d).done(function(b){a("#prospectivelist").append(b)}).fail(e.exception)}function i(){var b=a("#coursefilter").val();d.call([{methodname:"local_iomad_learningpath_getprospectivecourses",args:{pathid:g,filter:b},done:function(a){h(a)},fail:e.exception}])}function j(b){if(a("#pathcourselist li").remove(),!b.length)return void a("#nopathcourses").show();a("#nopathcourses").hide();var d={courses:b,wwwroot:c.wwwroot,prospective:!1};f.render("local_iomad_learningpath/pathcourselist",d).done(function(b){a("#pathcourselist").append(b)}).fail(e.exception)}function k(){d.call([{methodname:"local_iomad_learningpath_getcourses",args:{pathid:g},done:function(a){j(a)},fail:e.exception}])}function l(){a("#prospectivelist .path-delete").removeClass("fa-trash path-delete").addClass("fa-plus path-add"),a("#pathcourselist .path-add").removeClass("fa-plus path-add").addClass("fa-trash path-delete")}a('[data-toggle="tooltip"]').tooltip(),a(window).on("load",i()),a("#coursefilter").on("input",function(){i()}),a("#prospectivelist, #pathcourselist").on("mouseenter","li",function(){a(this).addClass("text-primary")}),a("#prospectivelist, #pathcourselist").on("mouseleave","li",function(){a(this).removeClass("text-primary")}),a(window).on("load",k()),a("#prospectivelist").on("click",".path-add",function(){var b=a(this).data("courseid");d.call([{methodname:"local_iomad_learningpath_addcourses",args:{pathid:g,courseids:[b]},done:function(){k(),i()},fail:e.exception}])}),a("#pathcourselist").on("click",".path-delete",function(){var b=a(this).data("courseid");d.call([{methodname:"local_iomad_learningpath_removecourses",args:{pathid:g,courseids:[b]},done:function(){k(),i()},fail:e.exception}])}),a("#pathcourselist").sortable({handle:".lphandle",connectWith:"#prospectivelist",dropOnEmpty:!0,update:function(){var b=[];a("#pathcourselist .pathbox").each(function(){b.push(a(this).data("courseid"))}),d.call([{methodname:"local_iomad_learningpath_ordercourses",args:{pathid:g,courseids:b},done:function(){},fail:e.exception}]),l()}}),a("#prospectivelist").sortable({handle:".lphandle",connectWith:"#pathcourselist",dropOnEmpty:!0,update:function(){l()}})}}});